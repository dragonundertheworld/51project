A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     1


MACRO ASSEMBLER A51 V8.2.7.0
OBJECT MODULE PLACED IN .\Objects\LCD.obj
ASSEMBLER INVOKED BY: D:\KEIL\C51\BIN\A51.EXE LCD.a51 SET(SMALL) DEBUG PRINT(.\Listings\LCD.lst) OBJECT(.\Objects\LCD.ob
                      j) EP

LOC  OBJ            LINE     SOURCE

                       1     ;DISPLAY:
                       2     ;RS BIT P2.0
                       3     ;RW BIT P2.1
                       4     ;E BIT P2.2
                       5     ;;-------------P0口选择模式+传数据，P2口传命令----------------
                       6     ;MAIN:
                       7     ;MOV P2,#0;防止上一次屏幕被清除
                       8     ;;MOV P2,#0ffh
                       9     ;;MOV P2,#1fh
                      10     ;MOV P0,#01H;清除屏幕
                      11     ;ACALL ENABLE
                      12     ;MOV P0,#38H;8位点阵方式
                      13     ;ACALL ENABLE
                      14     ;MOV P0,#0CH;开启显示屏，关光标，光标不闪烁
                      15     ;ACALL ENABLE
                      16     ;MOV P0,#06H;显示地址地址加1，即写一个数据后，显示位置右移一位 (指
                             令3)
                      17     ;ACALL ENABLE
                      18     
                      19     ;MOV P0,#80H;第一行起始地址
                      20     ;ACALL ENABLE
                      21     ;MOV DPTR,#table3;送数据表3
                      22     ;ACALL WRITE1;把数据放到里面并改为命令选择
                      23     ;MOV P0,#0C0h;第二行起始地址
                      24     ;ACALL ENABLE
                      25     ;MOV DPTR,#table2
                      26     ;ACALL WRITE1
                      27     ;;MOV P0,#0C2h;第二行的位置
                      28     ;;ACALL ENABLE
                      29     ;LJMP MAIN
                      30             
                      31     ;ENABLE:;根据时序图
                      32        ;CLR RS;RS=0时写状态
                      33        ;CLR RW;写
                      34        ;CLR E;不使能
                      35        ;ACALL DELAY;延时，让LCD准备接收指令       
                      36        ;SETB E;使能，指令送入
                      37        ;RET
                      38        
                      39     ;WRITE1: ;写数据
                      40         ;MOV R1,#00h
                      41         ;A1:
                      42         ;MOV A,R1
                      43         ;MOVC A,@A+DPTR;查表选择要显示的数据
                      44         ;ACALL WRITE2
                      45         ;INC R1
                      46         ;CJNE A,#00h,A1
                      47         ;RET
                      48             
                      49     ;WRITE2:
                      50     ;MOV P0,A;要显示的数据送给P0
                      51        ;SETB RS;RS=1时读数据
                      52        ;CLR RW;写
                      53        ;CLR E;不使能
                      54        ;ACALL DELAY;延时，让LCD准备接收数据       
                      55        ;SETB E;使能，指令送入
                      56        ;RET
A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     2

                      57        
                      58     ;DELAY:
                      59       ;MOV r7,#100
                      60       ;d1:MOV r6,#100
                      61       ;d2:DJNZ r6,d2
                      62       ;DJNZ r7,d1
                      63       ;RET
                      64       
                      65     ;table3: DB 01001111B,01001110B,20H,01010011B,01010000B,01000101B,01000101B,01000100B,00111
                             010B,00110101B,20H,01000001B,01010101B,01010100B,01001111B,20H,20H,20H,20H,20H;数据ON SPEED:5 AUTO
                      66     ;table2: DB 01010100B,01000101B,01001101B,01010000B,01000101B,01010010B,01000001B,01010100B
                             ,01010101B,01010010B,01000101B,00111010B,00110010B,00110110B,11011111B,01000011B;数据TEMPERATURE:26℃
                      67     ;END
                      68     
                      69     ;R0:命令 R1:字符 R2:行 R3:列 R5R6R7:延时  
0000                  70     ORG 0000H
0000 020030           71     LJMP 0030H
                      72     
0030                  73     ORG 0030H
0030 7838             74     INIT:MOV R0,#38H
0032 120170           75              LCALL W_M
0035 120192           76              LCALL DELAY
                      77     
0038 7808             78              MOV R0,#08H
003A 120170           79              LCALL W_M
003D 120192           80              LCALL DELAY
                      81     
0040 7801             82              MOV R0,#01H
0042 120170           83              LCALL W_M
0045 120192           84              LCALL DELAY
                      85     
0048 7806             86              MOV R0,#06H
004A 120170           87              LCALL W_M
004D 120192           88              LCALL DELAY
                      89     
0050 780C             90              MOV R0,#0CH
0052 120170           91              LCALL W_M
0055 120192           92              LCALL DELAY
                      93     
0058                  94     MAIN:
0058 7948             95     MOV R1,#48H;字符
005A 7A01             96     MOV R2,#1;行
005C 7B03             97     MOV R3,#3;列
005E 12014E           98     LCALL DISPLAY
                      99     
0061 7965            100     MOV R1,#65H;字符
0063 7A01            101     MOV R2,#1;行
0065 7B04            102     MOV R3,#4;列
0067 12014E          103     LCALL DISPLAY
                     104     
006A 796C            105     MOV R1,#6CH;字符
006C 7A01            106     MOV R2,#1;行
006E 7B05            107     MOV R3,#5;列
0070 12014E          108     LCALL DISPLAY
                     109     
0073 796C            110     MOV R1,#6CH;字符
0075 7A01            111     MOV R2,#1;行
0077 7B06            112     MOV R3,#6;列
0079 12014E          113     LCALL DISPLAY
                     114     
007C 796F            115     MOV R1,#6FH;字符
007E 7A01            116     MOV R2,#1;行
0080 7B07            117     MOV R3,#7;列
0082 12014E          118     LCALL DISPLAY
                     119     
0085 792C            120     MOV R1,#2CH;字符
A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     3

0087 7A01            121     MOV R2,#1;行
0089 7B08            122     MOV R3,#8;列
008B 12014E          123     LCALL DISPLAY
                     124     
008E 7957            125     MOV R1,#57H;字符
0090 7A01            126     MOV R2,#1;行
0092 7B09            127     MOV R3,#9;列
0094 12014E          128     LCALL DISPLAY
                     129     
0097 796F            130     MOV R1,#6FH;字符
0099 7A01            131     MOV R2,#1;行
009B 7B0A            132     MOV R3,#10;列
009D 12014E          133     LCALL DISPLAY
                     134     
00A0 7972            135     MOV R1,#72H;字符
00A2 7A01            136     MOV R2,#1;行
00A4 7B0B            137     MOV R3,#11;列
00A6 12014E          138     LCALL DISPLAY
                     139     
00A9 796C            140     MOV R1,#6CH;字符
00AB 7A01            141     MOV R2,#1;行
00AD 7B0C            142     MOV R3,#12;列
00AF 12014E          143     LCALL DISPLAY
                     144     
00B2 7964            145     MOV R1,#64H;字符
00B4 7A01            146     MOV R2,#1;行
00B6 7B0D            147     MOV R3,#13;列
00B8 12014E          148     LCALL DISPLAY
                     149     
00BB 7921            150     MOV R1,#21H;字符
00BD 7A01            151     MOV R2,#1;行
00BF 7B0E            152     MOV R3,#14;列
00C1 12014E          153     LCALL DISPLAY
                     154     
00C4 7954            155     MOV R1,#54H;字符
00C6 7A02            156     MOV R2,#2;行
00C8 7B01            157     MOV R3,#1;列
00CA 12014E          158     LCALL DISPLAY
                     159     
00CD 7968            160     MOV R1,#68H;字符
00CF 7A02            161     MOV R2,#2;行
00D1 7B02            162     MOV R3,#2;列
00D3 12014E          163     LCALL DISPLAY
                     164     
00D6 7961            165     MOV R1,#61H;字符
00D8 7A02            166     MOV R2,#2;行
00DA 7B03            167     MOV R3,#3;列
00DC 12014E          168     LCALL DISPLAY
                     169     
00DF 796E            170     MOV R1,#6EH;字符
00E1 7A02            171     MOV R2,#2;行
00E3 7B04            172     MOV R3,#4;列
00E5 12014E          173     LCALL DISPLAY
                     174     
00E8 796B            175     MOV R1,#6BH;字符
00EA 7A02            176     MOV R2,#2;行
00EC 7B05            177     MOV R3,#5;列
00EE 12014E          178     LCALL DISPLAY
                     179     
00F1 7920            180     MOV R1,#20H;字符
00F3 7A02            181     MOV R2,#2;行
00F5 7B06            182     MOV R3,#6;列
00F7 12014E          183     LCALL DISPLAY
                     184     
00FA 7979            185     MOV R1,#79H;字符
00FC 7A02            186     MOV R2,#2;行
A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     4

00FE 7B07            187     MOV R3,#7;列
0100 12014E          188     LCALL DISPLAY
                     189     
0103 796F            190     MOV R1,#6FH;字符
0105 7A02            191     MOV R2,#2;行
0107 7B08            192     MOV R3,#8;列
0109 12014E          193     LCALL DISPLAY
                     194     
010C 7975            195     MOV R1,#75H;字符
010E 7A02            196     MOV R2,#2;行
0110 7B09            197     MOV R3,#9;列
0112 12014E          198     LCALL DISPLAY
                     199     
0115 792C            200     MOV R1,#2CH;字符
0117 7A02            201     MOV R2,#2;行
0119 7B0A            202     MOV R3,#10;列
011B 12014E          203     LCALL DISPLAY
                     204     
011E 7946            205     MOV R1,#46H;字符
0120 7A02            206     MOV R2,#2;行
0122 7B0B            207     MOV R3,#11;列
0124 12014E          208     LCALL DISPLAY
                     209     
0127 7965            210     MOV R1,#65H;字符
0129 7A02            211     MOV R2,#2;行
012B 7B0C            212     MOV R3,#12;列
012D 12014E          213     LCALL DISPLAY
                     214     
0130 796E            215     MOV R1,#6EH;字符
0132 7A02            216     MOV R2,#2;行
0134 7B0D            217     MOV R3,#13;列
0136 12014E          218     LCALL DISPLAY
                     219     
0139 7967            220     MOV R1,#67H;字符
013B 7A02            221     MOV R2,#2;行
013D 7B0E            222     MOV R3,#14;列
013F 12014E          223     LCALL DISPLAY
                     224     
0142 7921            225     MOV R1,#21H;字符
0144 7A02            226     MOV R2,#2;行
0146 7B0F            227     MOV R3,#15;列
0148 12014E          228     LCALL DISPLAY
                     229     
                     230     
                     231     
014B 020058          232     LJMP MAIN
                     233     
014E                 234     DISPLAY:
014E DA05            235             DJNZ R2,H2
0150 7880            236     H1:     MOV R0,#80H
0152 020157          237             LJMP NEXT       
0155 78C0            238     H2: MOV R0,#0C0H
0157 E8              239     NEXT:MOV A,R0
0158 2B              240             ADD A,R3
0159 14              241             DEC A
015A F8              242             MOV R0,A
015B 120170          243             LCALL W_M
015E 120162          244             LCALL W_S
0161 22              245             RET
                     246     
0162 12017E          247     W_S:LCALL BUSY
0165 D290            248             SETB P1.0
0167 C291            249             CLR P1.1
0169 D2A5            250             SETB P2.5
016B 8980            251             MOV P0,R1
016D C2A5            252             CLR P2.5
A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     5

016F 22              253             RET
                     254     
0170 12017E          255     W_M:LCALL BUSY
0173 C290            256             CLR P1.0
0175 C291            257             CLR P1.1
0177 D2A5            258             SETB P2.5
0179 8880            259             MOV P0,R0
017B C2A5            260             CLR P2.5
017D 22              261             RET
                     262     
017E 7580FF          263     BUSY:MOV P0,#0FFH
0181 C290            264             CLR P1.0
0183 D291            265             SETB P1.1
0185 D2A5            266             SETB P2.5
0187 7F02            267             MOV R7,#02H
0189 DFFE            268             DJNZ R7,$
018B E580            269             MOV A,P0
018D 5480            270             ANL A,#80H
018F 70ED            271             JNZ BUSY
0191 22              272             RET
                     273     
0192                 274     DELAY:
0192 7E0F            275         MOV R6,#0FH
0194                 276     DL0:
0194 7D98            277         MOV R5,#98H
0196 DDFE            278         DJNZ R5,$
0198 DEFA            279         DJNZ R6,DL0
019A 22              280         RET
                     281     
                     282             END
A51 MACRO ASSEMBLER  LCD                                                                  05/24/2022 19:47:07 PAGE     6

SYMBOL TABLE LISTING
------ ----- -------


N A M E             T Y P E  V A L U E   ATTRIBUTES

BUSY . . . . . . .  C ADDR   017EH   A   
DELAY. . . . . . .  C ADDR   0192H   A   
DISPLAY. . . . . .  C ADDR   014EH   A   
DL0. . . . . . . .  C ADDR   0194H   A   
H1 . . . . . . . .  C ADDR   0150H   A   
H2 . . . . . . . .  C ADDR   0155H   A   
INIT . . . . . . .  C ADDR   0030H   A   
MAIN . . . . . . .  C ADDR   0058H   A   
NEXT . . . . . . .  C ADDR   0157H   A   
P0 . . . . . . . .  D ADDR   0080H   A   
P1 . . . . . . . .  D ADDR   0090H   A   
P2 . . . . . . . .  D ADDR   00A0H   A   
W_M. . . . . . . .  C ADDR   0170H   A   
W_S. . . . . . . .  C ADDR   0162H   A   


REGISTER BANK(S) USED: 0 


ASSEMBLY COMPLETE.  0 WARNING(S), 0 ERROR(S)
